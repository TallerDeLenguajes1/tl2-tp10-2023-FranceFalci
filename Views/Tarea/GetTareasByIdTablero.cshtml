@model List<IndexTareaViewModel>
<a asp-controller="Tarea" asp-action="CrearTareaForm" asp-route-IdTablero="@Model.FirstOrDefault().IdTablero">Agregar Tarea</a>


@* <h2>Product List</h2> *@
@* @{
  // Obtén los datos sincrónicamente
  var tasks = Model.Where(t => t.Estado == EstadoTarea.Ideas).ToList();
  var toDoTasks = Model.Where(t => t.Estado == EstadoTarea.ToDo).ToList();
  var doingTasks = Model.Where(t => t.Estado == EstadoTarea.Doing).ToList();
  var reviewTasks = Model.Where(t => t.Estado == EstadoTarea.Review).ToList();
  var doneTasks = Model.Where(t => t.Estado == EstadoTarea.Done).ToList();
} *@
@{
  var tareasPorEstado = Model.GroupBy(t => t.Estado).ToDictionary(group => group.Key, group => group.ToList());
  // Define el orden específico de los estados
  var ordenEstados = new List<EstadoTarea> { EstadoTarea.Ideas, EstadoTarea.ToDo, EstadoTarea.Doing, EstadoTarea.Review,
EstadoTarea.Done };

  // Ordena las tareasPorEstado según el orden definido
  var estadosOrdenados = tareasPorEstado
  .OrderBy(stateTasks => ordenEstados.IndexOf(stateTasks.Key));

}

<div class="d-flex">
  @foreach (var stateTasks in estadosOrdenados)
  {
    var estado = stateTasks.Key;
    var tareas = stateTasks.Value;
    var bgColor = GetColorClass(estado);
    <div class=" @bgColor m-2 p-4 contenedor-tareas " data-estado="@estado" > @estado
      @foreach (var tarea in tareas)
      {
        var colorClass = GetColorClass(tarea.Estado);

        <div class="card tarea  mb-4 text-white bg-dark " draggable="true" style="height:4rem; margin-left:1rem;"
          data-id="@tarea.Id" data-nombre="@tarea.Nombre" data-descripcion="@tarea.Descripcion" >

          <div class="card-header fw-bold">@tarea.Nombre</div>
          <button class="btn btn-dark">
            <a class=" text-decoration-none" asp-controller="Tarea" asp-action="EditarTarea"
              asp-route-idTarea="@tarea.Id">Editar</a>
          </button>
          <div class="card-body">
            <p class="card-text">@tarea.Descripcion</p>
            <button class="btn btn-dark">
              <a class="text-light text-decoration-none" asp-controller="Tarea" asp-action="EditarTarea"
                asp-route-idTarea="@tarea.Id">Editar</a>
            </button>
            <button class="btn btn-danger">
              <a class="text-light text-decoration-none" asp-controller="Tarea" asp-action="DeleteTarea"
                asp-route-idTarea="@tarea.Id" onclick="return confirmarEliminar('@tarea.Nombre');">Eliminar</a>
            </button> 
          </div>
        </div>
      }
    </div>
  }
</div>






<a asp-controller="Tarea" asp-action="CrearTareaForm" asp-route-IdTablero="">Agregar Tarea</a>





@functions {
  

  
  string GetColorClass(EstadoTarea estado)
  {
    switch (estado)
    {
      case EstadoTarea.Ideas:
        return "bg-danger";
      case EstadoTarea.ToDo:
        return "bg-secondary";
      case EstadoTarea.Doing:
        return "bg-warning";
      case EstadoTarea.Review:
        return "bg-success";
      case EstadoTarea.Done:
        return "bg-info";
      default:
        return ""; 
    }
  }


}


<script src="~/js/drag.js" asp-append-version="true"></script>
